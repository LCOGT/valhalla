{% extends 'base.html' %}
{% load i18n %}
{% block title %}Home{% endblock %}
{% block content %}
<div class="row">
    <div class="col-md-8">
    {% if user.is_authenticated %}
    {% block request_list %}
    {% endblock %}
    {% else %}
    <div class="jumbotron noauth">
        <h1>Observation Portal</h1>
        <p>The Observation Portal enables scientists to utilize Las Cumbres Observatory's global
        network of telescopes remotely at any time.</p>
        <p>Registered users have the ability to:</p>
        <ul class="list-unstyled">
            <li><i class="fa fa-wpexplorer fa-3x fa-pull-left fa-border" aria-hidden="true"></i><span>Compose, draft and submit observation requests to be observed on the network.</span>
            </li>
            <li><i class="fa fa-cloud-download fa-3x fa-pull-left fa-border" aria-hidden="true"></i><span>Track status of submitted observations, preview quicklook data and download final data products.</span></li>
            <li><i class="fa fa-group fa-3x fa-pull-left fa-border" aria-hidden="true"></i><span>Submit proposals, track progress and manage primary and co-investigators.</span></li>
        </ul>
        <a href="{% url 'registration_register' %}" class="btn btn-lg btn-default col-md-5">Register an Account</a>
        <a href="{% url 'auth_login' %}" class="btn btn-lg btn-default col-md-5 col-md-offset-2">Login</a>

    </div>
    {% endif %}
    </div>
    <div class="col-md-4">
        <div class="row">
            <div class="col-md-12">
                <h3>Quick Navigation</h3>
                <ul class="list-unstyled sidebar-nav">
                <li><a href="#"><i class="fa fa-wpexplorer fa-2x fa-fw"></i> Submit Observation</a></li>
                <li><a href="#"><i class="fa fa-group fa-2x fa-fw"></i> Manage Proposals</a></li>
                <li><a href="{% url 'sciapplications:index' %}"><i class="fa fa-pencil-square-o fa-2x fa-fw"></i> Submit a Proposal</a></li>
                </ul>
            </div>
        </div>
        {% include "partials/telescope_availability_chart.html" %}
        {% if user.is_authenticated %}
        <div class="row">
            <div class="col-md-12">
                <h3>Active Proposals</h3>
                {% for proposal in user.proposal_set.all %}
                <p><a href="{% url 'proposals:detail' pk=proposal.id %}">{{ proposal }}</a>
                <br/>
                <small>{{ proposal.title }}</small>
                </p>
                {% empty %}
                <p>{% trans 'You have no proposals' %}</p>
                <p>
                    <a href="{% url 'sciapplications:index' %}">
                    {% trans 'Apply for time' %}
                    </a>
                </p>
                {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}
{% block extra_javascript %}
{% load static bootstrap3 %}
<script src="{% static 'js/telescope_availability.js' %}"></script>
<script type="text/javascript">
$(document).ready(function(){
    var end_date = new Date();
    var start_date = new Date(end_date);
    start_date.setDate(start_date.getDate() - 3);
    start_date.setHours(0);
    start_date.setMinutes(0);
    start_date.setSeconds(0);
    var state_url = "{% url 'api:telescope_availability' %}" + "?start=" +
                     start_date.toISOString() + "&end=" + end_date.toISOString()
    $.getJSON(state_url, function(data) {
        create_telescope_availability_chart(data);
    });
});
</script>
{% endblock %}
